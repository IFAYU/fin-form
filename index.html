<!DOCTYPE html>
<html lang="zh-Hant">
<head>
  <meta charset="UTF-8">
  <title>個人財務分析表單</title>
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <style>
    body { font-family: 'Noto Sans TC', sans-serif; background: #f9f5f0; padding: 2rem; }
    form { background: #fff8f4; padding: 2rem; border-radius: 12px; max-width: 600px; margin: auto; box-shadow: 0 0 10px rgba(150, 115, 90, 0.2); color: #5c4a3c; }
    label { display: block; margin-top: 1rem; font-weight: bold; }
    input { width: 100%; padding: 0.5rem; border-radius: 6px; border: 1px solid #d8c3b1; }
    .step { display: none; }
    .step.active { display: block; }
    .button-group { display: flex; justify-content: space-between; margin-top: 2rem; }
    button { padding: 0.8rem 1.5rem; background: #d8bfa6; border: none; border-radius: 8px; color: #fff; font-weight: bold; cursor: pointer; }
    button:hover { background: #c5aa91; }
  </style>
</head>
<body>

<form id="financialForm">
  <h2>📊 個人財務分析測驗</h2>

  <!-- Step 1 -->
  <div class="step active" id="step1">
    <h3>🧾 第一段：資產分佈</h3>
    <label>你的暱稱</label><input name="nickname" required />
    <label>股票金額</label><input name="stock_amount" type="number" />
    <label>ETF 金額</label><input name="etf_amount" type="number" />
    <label>債券金額</label><input name="bond_amount" type="number" />
    <label>定存金額</label><input name="deposit_amount" type="number" />
    <label>房地產價值</label><input name="real_estate_value" type="number" />
    <label>現金</label><input name="cash_amount" type="number" />
    <div class="button-group">
      <button type="button" onclick="nextStep(2)">下一步 ▶</button>
    </div>
  </div>

  <!-- Step 2 -->
  <div class="step" id="step2">
    <h3>⏳ 第二段：退休規劃</h3>
    <label>目前歲數</label><input name="current_age" type="number" />
    <label>預計退休年紀</label><input name="retire_age" type="number" />
    <label>預計活到的年紀</label><input name="life_expectancy" type="number" />
    <label>退休後預期每月開銷</label><input name="monthly_expense" type="number" />
    <label>已準備退休金</label><input name="retirement_fund_prepared" type="number" />
    <label>預期年報酬率（%）</label><input name="expected_rate" type="number" />
    <div class="button-group">
      <button type="button" onclick="nextStep(1)">◀ 上一步</button>
      <button type="button" onclick="submitForm()">📮 送出</button>
    </div>
  </div>
</form>

<script>
  const SCRIPT_URL = 'https://script.google.com/macros/s/AKfycbwexoQBjL4du4niET5R5LxO_9hoLgyTUwcbebm6_H5sfmakRnRAfFm6wLViO03lYOJH/exec'; // 換成你的 Apps Script Web App

  function nextStep(step) {
    document.querySelectorAll('.step').forEach(el => el.classList.remove('active'));
    document.getElementById('step' + step).classList.add('active');
  }

  function submitForm() {
    const form = document.getElementById('financialForm');
    const data = Object.fromEntries(new FormData(form).entries());

    fetch(SCRIPT_URL, {
      method: 'POST',
      mode: 'no-cors',
      headers: { 'Content-Type': 'application/json' },
      body: JSON.stringify(data)
    });

    alert("✅ 已送出成功");
    form.reset();
    nextStep(1);
  }
</script>

</body>
</html>
